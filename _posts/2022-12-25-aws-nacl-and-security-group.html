---
categories: ['AWS', 'General']
layout: post
title: AWS NACL and Security Group?
date: 2022-12-25 04:42:12.000000000 -05:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
- AWS
tags: []
meta:
  _edit_last: '1'
  _aioseo_title: ''
  _aioseo_description: ''
  _aioseo_keywords: ''
  _aioseo_og_title: ''
  _aioseo_og_description: ''
  _aioseo_og_article_section: ''
  _aioseo_og_article_tags: ''
  _aioseo_twitter_title: ''
  _aioseo_twitter_description: ''
  ocean_gallery_link_images: 'off'
  ocean_sidebar: '0'
  ocean_second_sidebar: '0'
  ocean_disable_margins: enable
  ocean_display_top_bar: default
  ocean_display_header: default
  ocean_center_header_left_menu: '0'
  ocean_custom_header_template: '0'
  ocean_header_custom_menu: '0'
  ocean_menu_typo_font_family: '0'
  ocean_disable_title: default
  ocean_disable_heading: default
  ocean_disable_breadcrumbs: default
  ocean_display_footer_widgets: default
  ocean_display_footer_bottom: default
  ocean_custom_footer_template: '0'
  ocean_link_format_target: self
  ocean_quote_format_link: post
  _yoast_wpseo_estimated-reading-time-minutes: '3'
  _yoast_wpseo_primary_category: '27'
  _yoast_wpseo_content_score: '90'
  _thumbnail_id: '1778'
  _wtpsw_views: '48'
  _wp_old_slug: aws-nacl-network-access-control-list-v-s-security-groups
  _yoast_wpseo_focuskw: NACL Security Group
  _yoast_wpseo_linkdex: '73'
  _yoast_wpseo_wordproof_timestamp: ''
  rank_math_primary_category: '27'
  rank_math_focus_keyword: nacl,security group,aws
  rank_math_news_sitemap_robots: index
  rank_math_robots: a:1:{i:0;s:5:"index";}
  rank_math_seo_score: '87'
  rank_math_internal_links_processed: '1'
  rank_math_ca_keyword: a:2:{s:7:"keyword";s:4:"nacl";s:7:"country";s:3:"all";}
  rank_math_contentai_score: a:5:{s:9:"wordCount";s:3:"100";s:9:"linkCount";s:5:"11.43";s:12:"headingCount";s:5:"26.67";s:10:"mediaCount";s:1:"0";s:8:"keywords";s:5:"28.57";}
  rank_math_og_content_image: a:2:{s:5:"check";s:32:"5d8fe74c254d73b4ee7e28d4c38d9376";s:6:"images";a:1:{i:0;i:1769;}}
permalink: "/2022/12/25/aws-nacl-and-security-group/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<!-- wp:paragraph {"fontSize":"medium"} --><html><body></p>
<p class="has-medium-font-size">Both NACL and Security Group function as virtual firewalls in your VPC; however, there's a key distinction between them. NACL operates at the subnet level, whereas Security Group functions as an instance-level firewall.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":4} --></p>
<h4>
<span style="text-decoration: underline" class="underline"><span style="color:#cf2e2e" class="tadv-color"><strong>About NACL (Network Access Control List</strong></span></span><strong><span style="color:#cf2e2e" class="tadv-color">)</span></strong><br />
</h4>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size">NACLs are associated with a subnet in the VPC and govern the allowance or denial of traffic at the subnet level. Every VPC comes with a default NACL that, by default, permits all incoming and outgoing traffic to the subnet.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size">We have the flexibility to modify the default NACL or create a custom one based on our requirements. However, it's important to note that each subnet must be associated with one NACL.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size">An NACL consists of inbound or outbound rules, each numbered from 1 to 32766. These rules are evaluated sequentially, with the lowest-numbered rules receiving the highest priority in case of a conflict.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":1769,"width":775,"height":173,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large is-resized"><img src="{{site.baseurl}}/assets/2022/12/image-19-1024x231.png" alt="" class="wp-image-1769" width="775" height="173"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size"><br>NACLs are stateless, meaning they do not maintain any connection state. For every response to allowed inbound traffic, there must be a corresponding outbound rule explicitly defined (and vice versa).</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size">Now, considering an example where we have an NACL rule allowing HTTP traffic from everywhere on port 80 and a client on the internet is attempting to access a web page hosted on your EC2 instance on port 80, the client's request would be like:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code><strong>Src IP</strong>: client IP
<strong>Src Port</strong>: Any of the port in the <mark class="kt-highlight">ephemeral ports</mark> range (typically 1024-65535)
<strong>Dst IP</strong>: EC2 instance or ELB IP
<strong>Dst Port</strong>: 80</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size">To ensure the response from the EC2 instance or ELB reaches the actual client, we must have an outbound rule explicitly defined. The outbound rule should be as follows:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code><strong>Destination</strong>: 0.0.0.0/0
<strong>Port range</strong>: <mark class="kt-highlight">ephemeral ports range</mark></code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size">In terms of the Port range, it's essential to choose the <code>ephemeral ports</code> range. This is because the actual client's source port, to which the response has to be sent, is dynamic and can be any port within the  <code><a title="ephemeral ports range" href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#nacl-ephemeral-ports">ephemeral ports range</a></code>. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":1771,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2022/12/image-21-1024x181.png" alt="" class="wp-image-1771"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph {"style":{"typography":{"fontSize":17}}} --></p>
<p style="font-size:17px"><br></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":4,"style":{"typography":{"fontSize":26}}} --></p>
<h4 style="font-size:26px"><strong><span style="text-decoration: underline" class="underline"><span style="color:#cf2e2e" class="tadv-color">About Security Groups</span></span></strong></h4>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph {"fontSize":"medium"} --></p>
<p class="has-medium-font-size">Security Groups are associated with an EC2 instance in the VPC and regulate traffic at the EC2 instance level.<br><br>Unlike NACL:<br>1) Security Groups cannot have rules (Inbound/Outbound) that deny access to resources.<br>2)  Security Groups are stateful, meaning responses to allowed inbound traffic are automatically permitted to flow out. This behavior occurs regardless of any specific outbound rules defined in the Security Group. This is possible because Security Groups maintain a connection state, tracking connections to and from the EC2 instances.<br></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"style":{"typography":{"fontSize":17}}} --></p>
<p style="font-size:17px"><br><br></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"style":{"typography":{"fontSize":17}}} --></p>
<p style="font-size:17px"><br> <br><br></p>
<p><!-- /wp:paragraph --><br />
</body></html></p>
