---
layout: post
title: what's the need for getopts shell builtin?
date: 2021-05-29 16:24:21.000000000 -04:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Linux
tags: []
meta:
  _edit_last: '1'
  ocean_gallery_link_images: 'off'
  ocean_sidebar: '0'
  ocean_second_sidebar: '0'
  ocean_disable_margins: enable
  ocean_display_top_bar: default
  ocean_display_header: default
  ocean_center_header_left_menu: '0'
  ocean_custom_header_template: '0'
  ocean_header_custom_menu: '0'
  ocean_menu_typo_font_family: '0'
  ocean_disable_title: default
  ocean_disable_heading: default
  ocean_disable_breadcrumbs: default
  ocean_display_footer_widgets: default
  ocean_display_footer_bottom: default
  ocean_custom_footer_template: '0'
  ocean_link_format_target: self
  ocean_quote_format_link: post
  _yoast_wpseo_estimated-reading-time-minutes: '4'
  _yoast_wpseo_content_score: '60'
  _yoast_wpseo_primary_category: '2'
  _thumbnail_id: '844'
  _wtpsw_views: '92'
  _aioseo_title: ''
  _aioseo_description: ''
  _aioseo_keywords: ''
  _aioseo_og_title: ''
  _aioseo_og_description: ''
  _aioseo_og_article_section: ''
  _aioseo_og_article_tags: ''
  _aioseo_twitter_title: ''
  _aioseo_twitter_description: ''
  rank_math_primary_category: '2'
  rank_math_news_sitemap_robots: index
  rank_math_robots: a:1:{i:0;s:5:"index";}
  rank_math_og_content_image: a:2:{s:5:"check";s:32:"6f600f8046bb5e39aa2059755257d3ec";s:6:"images";a:1:{i:0;i:820;}}
  rank_math_internal_links_processed: '1'
  _yoast_wpseo_wordproof_timestamp: ''
permalink: "/2021/05/29/whats-the-need-of-getopts-shell-builtin/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<!-- wp:tadv/classic-paragraph --><html><body></p>
<p><span style="font-size: 20px;">The 'getopts' command is a built-in tool in shell scripting. It helps in handling different types of input when working with scripts. It can process information in two ways:</span></p>
<ul>
<li><span style="font-size: 20px;">It can recognize single options/flags, like '-h' or '-c'.</span></li>
<li><span style="font-size: 20px;">It can also handle options/flags that come with additional data, for example, '-h 20' or '-c 45'.</span></li>
</ul>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:heading --></p>
<h2><span style="text-decoration: underline" class="underline"><span style="color:#ff6900" class="tadv-color">Syntax:</span></span></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>getopts: getopts optstring name [arg]</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p><span style="font-size: 20px;">In this context:</span></p>
<ul>
<li><span style="font-size: 20px;">'<strong>optstring</strong>' contains a list of options or flags that 'getopts' recognizes.</span></li>
<li><span style="font-size: 20px;">'<strong>name</strong>' is a variable that holds each option, one at a time, during script execution.</span></li>
<li><span style="font-size: 20px;">'<strong>arg'</strong> is an optional set of parameters that 'getopts' can process. If 'arg' isn’t specified, 'getopts' looks at the <strong>command-line arguments</strong> provided and handles them accordingly, whether they are single options/flags or options/flags with associated data.</span></li>
</ul>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p> </p>
<p> </p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:heading {"level":1} --></p>
<h1><span style="text-decoration: underline" class="underline"><span style="color:#ff6900" class="tadv-color">Example using just options/flags</span></span></h1>
<p><!-- /wp:heading --></p>
<p><!-- wp:code {"fontSize":"medium"} --></p>
<pre class="wp-block-code has-medium-font-size"><code><span style="color:#313131" class="tadv-color">#!/bin/bash

while getopts "ab" option_char                    
do
  case $option_char in
  a)<span style="background-color:#eeeeee" class="tadv-background-color">
</span>    echo "option a is called and its argument is $OPTARG"
    ;;
  b)
    echo "option b is called and its argument $OPTARG"
    ;;
  ?)
    echo "$OPTARG is not a valid option."
    ;;
  esac
done</span>
</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p><span style="font-size: 20px;"><span style="text-decoration: underline;"><strong>Explaining the 'while getopts' line:</strong></span><br><span class="hljs-comment"> 1) 'getopts' looks for provided options 'a' or 'b'.<br></span><span class="hljs-comment"> 2) If 'a' or 'b' is passed as an argument, the case statement executes accordingly.</span> <br><br><span style="text-decoration: underline;"><strong><span class="hljs-comment">About $OPTARG:</span></strong></span> <br><span class="hljs-comment">1) It contains the argument value passed to an option.<br></span><span class="hljs-comment">2) If no argument is provided, $OPTARG remains empty.<br></span><span class="hljs-comment">3) In this script, 'a' and 'b' options don’t take arguments, so $OPTARG will be empty.</span></span></p>
<p> </p>
<p><span style="text-decoration: underline; color: #ff6600;"><strong><span style="font-size: 20px;">Output</span></strong></span></p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:image {"id":820,"width":777,"height":259,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large is-resized"><img src="{{site.baseurl}}/assets/2021/05/getopts-option.png" alt="" class="wp-image-820" width="777" height="259"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:tadv/classic-paragraph /--></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p> </p>
<p> </p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:heading {"level":1} --></p>
<h1><span style="text-decoration: underline" class="underline"><span style="color:#ff6900" class="tadv-color">Example using options/flags with arguments</span></span></h1>
<p><!-- /wp:heading --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code><span style="color:#313131" class="tadv-color">#!/bin/bash

while getopts "a:b:" option_char
do
  case $option_char in
  a)
    echo "option a is called and its argument is $OPTARG"
    ;;
  b)
    echo "Option b is called and its argument $OPTARG"
    ;;
  ?)
    echo "$OPTARG is not a valid option."
    ;;
  esac
done</span>
</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p><span style="text-decoration: underline;"><strong><span class="hljs-comment" style="font-size: 20px;"> Explaining the 'while getopts' line: </span></strong></span><br><span style="font-size: 20px;"><span class="hljs-comment"> 1) 'getopts' looks for provided options 'a' or 'b'.<br></span><span class="hljs-comment"> 2) 'a' expects an argument, while 'b' expects an argument, the colon (<code>:</code>) following the option characters (<code>a:</code> and <code>b:</code>) in the <code>getopts</code> command signifies that these options are expected to be followed by an argument.</span></span><br><span class="hljs-comment" style="font-size: 20px;"> 3) If an argument is not provided with 'a' or 'b', an error message is displayed.<br></span></p>
<p> </p>
<p><span style="text-decoration: underline;"><strong><span class="hljs-comment" style="font-size: 20px;">About $OPTARG: </span></strong></span><br><span class="hljs-comment" style="font-size: 20px;">1) It contains the argument value passed to an option. </span><br><span class="hljs-comment" style="font-size: 20px;">2) If an argument is expected but not provided, $OPTARG will be empty. </span><br><span class="hljs-comment" style="font-size: 20px;">3) In this script, the 'a' and 'b' options require arguments, so $OPTARG will contain the argument passed.</span></p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:heading {"level":1} --></p>
<h1><strong><span style="text-decoration: underline" class="underline"><span style="color:#ff6900" class="tadv-color">Output:</span></span></strong></h1>
<p><!-- /wp:heading --></p>
<p><!-- wp:image {"id":825,"width":773,"height":297,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large is-resized"><img src="{{site.baseurl}}/assets/2021/05/getops-option1.png" alt="" class="wp-image-825" width="773" height="297"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p> </p>
<p> </p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:heading {"level":1} --></p>
<h1><span style="text-decoration: underline" class="underline"><span style="color:#ff6900" class="tadv-color">How do getopts report errors?</span></span></h1>
<p><!-- /wp:heading --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p><span style="font-size: 20px;"><strong>Getopts in Bash reports errors in two ways:</strong></span><br><br></p>
<ul>
<li><span style="text-decoration: underline;"><span style="font-size: 20px;"><strong>Silent Error Reporting (Leading Colon)</strong>:</span></span></li>
<li style="list-style-type: none;">
<ul>
<li><span style="font-size: 20px;">If the first character of OPTSTRING is a colon, getopts uses silent error reporting.</span></li>
<li><span style="font-size: 20px;">No error messages are printed.</span></li>
<li><span style="font-size: 20px;">If a required argument is missing, a "?" is assigned to the 'name' variable, and the related case statement executes.<br><br></span></li>
</ul>
</li>
<li>
<p><span style="text-decoration: underline;"><span style="font-size: 20px;"><strong>Verbose Error Reporting (No Leading Colon)</strong>:</span></span></p>
<ul>
<li><span style="font-size: 20px;">If the first character of OPTSTRING is not a colon, silent error reporting is disabled.</span></li>
<li><span style="font-size: 20px;">Diagnostic messages are printed for errors.</span></li>
<li><span style="font-size: 20px;">Missing required arguments or invalid options trigger diagnostic messages.</span></li>
<li><span style="font-size: 20px;">In case of an error, a "?" is assigned to the 'name' variable, and the related case statement also executes.</span></li>
</ul>
</li>
</ul>
<p><br><br><br></p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p><span style="text-decoration: underline; color: #ff9900; font-size: 20px;"><strong>Testing the first way (silent error reporting) practically</strong></span></p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code><span style="color:#313131" class="tadv-color"><span style="background-color:#eeeeee" class="tadv-background-color">#!/bin/bash

</span></span><span style="background-color:#eeeeee" class="tadv-background-color"><span style="color:#ff6900" class="tadv-color"><strong>while getopts ":a:b:" option_char</strong></span></span><span style="color:#313131" class="tadv-color"><span style="background-color:#eeeeee" class="tadv-background-color">     </span></span><span style="background-color:#eeeeee" class="tadv-background-color"><span style="color:#cf2e2e" class="tadv-color">#silent error reporting enabled
</span><span style="color:#313131" class="tadv-color">do</span></span><span style="color:#313131" class="tadv-color"><span style="background-color:#eeeeee" class="tadv-background-color">
  case $option_char in
  a)
    echo "option a is called and its argument is $OPTARG"
    ;;
  b)
    echo "Option b is called and its argument $OPTARG"
    ;;
  ?)
    echo "$OPTARG is not a valid option."
    ;;
  esac
done
</span></span></code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading --></p>
<h2><span style="text-decoration: underline" class="underline"><span style="color:#ff6900" class="tadv-color">Output:</span></span></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:image {"id":831,"width":784,"height":155,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large is-resized"><img src="{{site.baseurl}}/assets/2021/05/getopts-3.png" alt="" class="wp-image-831" width="784" height="155"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p> </p>
<p> </p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p><span style="text-decoration: underline;"><strong><span style="font-size: 20px; color: #ff6600; text-decoration: underline;">Testing the second way (silent error reporting disabled) practically</span></strong></span></p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code><span style="color:#313131" class="tadv-color"><span style="background-color:#eeeeee" class="tadv-background-color">#!/bin/bash

</span></span><span style="background-color:#eeeeee" class="tadv-background-color"><span style="color:#ff6900" class="tadv-color"><strong>while getopts "a:b:" option_char</strong></span></span><span style="color:#313131" class="tadv-color"><span style="background-color:#eeeeee" class="tadv-background-color"><strong> </strong>     </span></span><span style="background-color:#eeeeee" class="tadv-background-color"><span style="color:#cf2e2e" class="tadv-color"># silent error reporting disabled</span></span><span style="color:#313131" class="tadv-color"><span style="background-color:#eeeeee" class="tadv-background-color">
do
  case $option_char in
  a)
    echo "option a is called and its argument is $OPTARG"
    ;;
  b)
    echo "Option b is called and its argument $OPTARG"
    ;;
  ?)
    echo "$OPTARG is not a valid option."
    ;;
  esac
done</span></span>
</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading --></p>
<h2><span style="text-decoration: underline" class="underline"><span style="color:#ff6900" class="tadv-color">Output:</span></span></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:image {"id":833,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2021/05/getopts-4.png" alt="" class="wp-image-833"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":1,"fontSize":"medium"} --></p>
<h1 class="has-medium-font-size"><span style="text-decoration: underline" class="underline"><span style="color:#cf2e2e" class="tadv-color">Points to be noted:<br></span></span></h1>
<p><!-- /wp:heading --></p>
<p><!-- wp:tadv/classic-paragraph --></p>
<p id="block-153859b2-b404-4b87-9864-8b6aa318093d" class="block-editor-rich-text__editable block-editor-block-list__block wp-block is-selected rich-text" tabindex="0" role="group" contenteditable="true" aria-multiline="true" aria-label="Block: Heading" data-block="153859b2-b404-4b87-9864-8b6aa318093d" data-type="core/heading" data-title="Heading"><span style="font-size: 20px;">When <code>getopts</code> identifies an option from the script's command line, it internally maintains the index of the option in the shell variable <code>OPTIND</code>. This approach allows <code>getopts</code> to effectively manage and process options, particularly those that come with associated arguments. Instead of utilizing the <code>shift</code> command to cycle through all the options, <code>getopts</code> intelligently handles the parsing and processing of individual options and their arguments, simplifying the script's logic.</span></p>
<p><!-- /wp:tadv/classic-paragraph --></p>
<p><!-- wp:image {"id":839,"width":779,"height":97,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large is-resized"><img src="{{site.baseurl}}/assets/2021/05/getopts-5.png" alt="" class="wp-image-839" width="779" height="97"></figure>
<p><!-- /wp:image --><br />
</body></html></p>
